---
title: "Graph Objects"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Graph Objects}
  %\VignetteEngine{quarto::html}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  eval = FALSE
)
```

```{r setup}
library(blockr.dag)
```

# Graph Objects

This vignette covers the core graph data structures and how they're transformed for visualization.

## Core Graph Structure

The [`new_graph`](R/graph.R) function creates the core data structure:

```{r}
# Core graph structure
graph <- new_graph(
  nodes = list(), # Block representations
  edges = list(), # Link representations
  combos = list() # Stack representations
)
```

## Data Transformation Pipeline

The package transforms between different data representations:

```{mermaid}
graph LR
    A[Board State] --> B[g6_data_from_board]
    B --> C[g6_nodes_from_blocks]
    B --> D[g6_edges_from_links] 
    B --> E[g6_combos_data_from_stacks]
    C --> F[g6 Widget Data]
    D --> F
    E --> F
    F --> G[Visual Rendering]
```

## Key Transformation Functions

- [`g6_nodes_from_blocks`](R/g6r.R): Converts blocks to visual nodes
- [`g6_edges_from_links`](R/g6r.R): Converts links to visual edges
- [`g6_combos_data_from_stacks`](R/g6r.R): Converts stacks to visual combos

## Data Flow

```{mermaid}
sequenceDiagram
    participant U as User
    participant UI as UI Layer
    participant S as Server
    participant B as Board
    participant G as g6 Widget
    
    U->>UI: Interact with graph
    UI->>S: Shiny input event
    S->>B: Update board state
    B->>S: Reactive update
    S->>G: Proxy update
    G->>UI: Visual update
```

## Performance Considerations

- **Proxy operations** update only changed elements.